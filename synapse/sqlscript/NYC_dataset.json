{
	"name": "NYC_dataset",
	"properties": {
		"content": {
			"query": "select * from deltactas\n\n\n\nCREATE EXTERNAL FILE FORMAT file_format_name11\nWITH (  \n         FORMAT_TYPE = PARQUET \n    );    \n\n\n/*read from delta*/\n\nCREATE CREDENTIAL ServiceIdentity1 WITH IDENTITY = 'Managed Identity';\nGO\n\n\nCREATE EXTERNAL TABLE table_name22222\n    ( Column1 varchar(100))  \n    WITH (   \n        LOCATION = '/testdatetime/dbo.Table1.parquet',  \n        DATA_SOURCE = AzureDataLakeStore1,  \n        FILE_FORMAT = file_format_name11);  \n\nselect * \nfrom table_name22222\n\n--cannot insert into storage directly in synapse -- only with CTAS to external table\ninsert into table_name22222 values ('x');\n\n--output data to storage using CTAS\nCREATE EXTERNAL TABLE table_name22222SYNAPSE\n    WITH (  \n        LOCATION = '/testdatetime/dboTable1parquet/synapse-output',  \n        DATA_SOURCE = AzureDataLakeStore1,  \n        FILE_FORMAT = file_format_name11   \n    )\n    AS SELECT * from dbo.NYCdata;\n\n\nselect *\nfrom table_name2222;\n\nSELECT TOP 10 *\nFROM OPENROWSET(\n        BULK 'covid',\n        DATA_SOURCE = 'DeltaLakeStorage',\n        FORMAT = 'delta'\n    ) as rows;\n\n\nselect *\nfrom dbo.x_del\n\nselect *\nfrom dbo.NYCdata\n\ndrop table dbo.NYCdata;\ncreate table dbo.NYCdata (x VARCHAR(1));\n\n/*\nFull tutorial available on: https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/tutorial-data-analyst\nIn this tutorial, you learn how to perform exploratory data analysis by combining different Azure Open Datasets\nusing serverless SQL pool and then visualizing the results in Azure Synapse Studio.\n\nIn particular, you analyze the New York City (NYC) Taxi dataset that includes:\n\n - Pickup and drop-off dates and times.\n - Pick up and drop-off locations.\n - Trip distances.\n - Itemized fares.\n - Rate types.\n - Payment types.\n - Driver-reported passenger counts.*/\n\n\n/*\n * * * * * * * * * * * * * * * *\n * Automatic schema inference  *\n * * * * * * * * * * * * * * * *\n\nSince data is stored in the Parquet file format, automatic schema inference is available.\nYou can easily query the data without listing the data types of all columns in the files.\nYou also can use the virtual column mechanism and the filepath function to filter out a certain subset of files.\n\nLet's first get familiar with the NYC Taxi data by running the following query. */\ncreate table x \nSELECT * FROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=2019/puMonth=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [nyc];\n\n\n/* Similarly, you can query the Public Holidays dataset by using the following query. */\n\nSELECT TOP 100 * FROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/holidaydatacontainer/Processed/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [holidays];\n\n/* Lastly, you can also query the Weather Data dataset by using the following query. */\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/isdweatherdatacontainer/ISDWeather/year=2018/month=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [weather];\n\n/* You can learn more about the meaning of the individual columns in the descriptions\nof the NYC Taxi, Public Holidays, and Weather Data datasets on the Azure Opendatasets page. */\n\n\n/*\n * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Time series, seasonality, and outlier analysis  *\n * * * * * * * * * * * * * * * * * * * * * * * * * *\nYou can easily summarize the yearly number of taxi rides by using the following query. */\nÂ´\ncreate database exploration;\n\nCREATE CREDENTIAL ServiceIdentity1 WITH IDENTITY = 'Managed Identity';\nGO\n\ncreate external data source my_source\nwith (\n    LOCATION = 'abfss://pombofs@pomboadlsgen22.dfs.core.windows.net',\n    credential = ServiceIdentity1\n)\n\n\nselect *\nfrom exploration.dbo.xx_complete;\n\nCREATE EXTERNAL TABLE xx\n  WITH (\n        LOCATION = '',  \n        DATA_SOURCE = external_data_source_name,  \n        FILE_FORMAT = external_file_format_name  \n) as \nSELECT\n    YEAR(tpepPickupDateTime) AS current_year,\n    COUNT(*) AS rides_per_year\nFROM\n    OPENROWSET(\n        BULK 'https://azureopendatastorage.blob.core.windows.net/nyctlc/yellow/puYear=*/puMonth=*/*.parquet',\n        FORMAT='PARQUET'\n    ) AS [nyc]\nWHERE nyc.filepath(1) >= '2014' AND nyc.filepath(1) <= '2019'\nGROUP BY YEAR(tpepPickupDateTime)\nORDER BY 1 ASC;\n\n/* The data can be visualized in Synapse Studio by switching from the Table to the Chart view.\nYou can choose among different chart types, such as Area, Bar, Column, Line, Pie, and Scatter.\nIn this case, plot the Column chart with the Category column set to current_year.\n\nFrom this visualization, a trend of a decreasing number of rides over years can be clearly seen.\nPresumably, this decrease is due to the recent increased popularity of ride-sharing companies.\n*/\n\n\n/* For full tutorial click on \"?\" in top right corner then Knowledge center/Browse Available Samples/SQL Scripts/Analyze Azure Open Datasets using serverless SQL pool*/\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "exploration",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}