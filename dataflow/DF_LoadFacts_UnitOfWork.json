{
	"name": "DF_LoadFacts_UnitOfWork",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_UnitOfWorkSRC",
						"type": "DatasetReference"
					},
					"name": "SRCUnitOfWork"
				},
				{
					"dataset": {
						"referenceName": "DS_DimProfile",
						"type": "DatasetReference"
					},
					"name": "DimProfile"
				},
				{
					"dataset": {
						"referenceName": "DS_DimTransactionCategory",
						"type": "DatasetReference"
					},
					"name": "DimTransactionCategory"
				},
				{
					"dataset": {
						"referenceName": "DS_DimTransactionType",
						"type": "DatasetReference"
					},
					"name": "DimTransactionType"
				},
				{
					"dataset": {
						"referenceName": "DS_DimDate",
						"type": "DatasetReference"
					},
					"name": "DimDate"
				},
				{
					"dataset": {
						"referenceName": "DS_DimRequestSource",
						"type": "DatasetReference"
					},
					"name": "DimRequestSource"
				},
				{
					"dataset": {
						"referenceName": "DS_DimClient",
						"type": "DatasetReference"
					},
					"name": "DimClient"
				},
				{
					"dataset": {
						"referenceName": "DS_Product",
						"type": "DatasetReference"
					},
					"name": "DimProduct"
				},
				{
					"dataset": {
						"referenceName": "DS_DimGroup",
						"type": "DatasetReference"
					},
					"name": "DimGroup"
				},
				{
					"dataset": {
						"referenceName": "DS_DimContentProvider",
						"type": "DatasetReference"
					},
					"name": "DimContentProvider"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_FactUnitOfWork",
						"type": "DatasetReference"
					},
					"name": "DSTFactUnitOfWork"
				}
			],
			"transformations": [
				{
					"name": "JoinProfile"
				},
				{
					"name": "JoinTransactionCategory"
				},
				{
					"name": "JoinEstimatedTransactionType"
				},
				{
					"name": "JoinRequestSource"
				},
				{
					"name": "JoinActualTransactionType"
				},
				{
					"name": "SelectDimProfile"
				},
				{
					"name": "SelectDimTransactionCategory"
				},
				{
					"name": "SelectDimTransactionType"
				},
				{
					"name": "SelectDimDate"
				},
				{
					"name": "FixEstimatedTransactionTypeColumnName"
				},
				{
					"name": "SelectDimRequestSource"
				},
				{
					"name": "FixActualTransactionTypeColumnName"
				},
				{
					"name": "SelectDimClient"
				},
				{
					"name": "JoinDimClient"
				},
				{
					"name": "FixDimClientColumns"
				},
				{
					"name": "JoinOnbehalfProfile"
				},
				{
					"name": "FixOnbehalfProfileColumnName"
				},
				{
					"name": "FixProfileColumns"
				},
				{
					"name": "FixCategoryColumns"
				},
				{
					"name": "FixDateColumns"
				},
				{
					"name": "FixRequestSourceColumns"
				},
				{
					"name": "DefaultColumns"
				},
				{
					"name": "SetisCurrentDefault"
				},
				{
					"name": "FixCCPRequestColumns"
				},
				{
					"name": "SetTransactionCompletedFinMonth"
				},
				{
					"name": "SelectDimProduct"
				},
				{
					"name": "JoinDimProduct"
				},
				{
					"name": "FixDimProductColumns"
				},
				{
					"name": "SelectDimGroup"
				},
				{
					"name": "JoinDimGroup"
				},
				{
					"name": "FixDimGroup"
				},
				{
					"name": "JoinDimContentProvider"
				},
				{
					"name": "SelectDimContentProvider"
				},
				{
					"name": "FixContentProvider"
				}
			],
			"script": "source(output(\n\t\tUnitOfWorkId as integer,\n\t\tReferenceNumber as string,\n\t\tMonthlyBalanceControlId as integer,\n\t\tGroupId as integer,\n\t\tProfileId as integer,\n\t\tTransactionCategoryId as integer,\n\t\tEstimatedTransactionTypeId as integer,\n\t\tActualTransactionTypeId as integer,\n\t\tEstimatedTransactionValue as decimal(38,18),\n\t\tActualTransactionValue as decimal(38,18),\n\t\tExcessTransactionValue as decimal(38,18),\n\t\tIsTransactionComplete as boolean,\n\t\tIsExcessTransaction as boolean,\n\t\tIsDeferredPriceCalculation as boolean,\n\t\tRequiresInvoiceRequest as boolean,\n\t\tInvoiceRequestId as integer,\n\t\tDateTimeTransactionStarted as timestamp,\n\t\tDateTimeTransactionComplete as timestamp,\n\t\tIsContentProviderTransaction as boolean,\n\t\tContentProviderBillingId as integer,\n\t\tOnBehalfOfProfileId as integer,\n\t\tQuantity as integer,\n\t\tMyClientId as integer,\n\t\tCoreOrProducts as boolean,\n\t\tCcpServiceId as integer,\n\t\tCNFRateId as integer,\n\t\tParentId as integer,\n\t\tContentProviderTransTypeID as integer,\n\t\tCcpRequestId as integer,\n\t\tMessageId as string,\n\t\tCombineId as string,\n\t\tCcpProductId as integer,\n\t\tRequestSourceCode as string,\n\t\tIdNumber as string,\n\t\tIdType as integer,\n\t\tInitials as string,\n\t\tSurname as string,\n\t\tCellNumber as string,\n\t\tEmailAddress as string,\n\t\tFirstName as string,\n\t\tDateOfBirth as timestamp,\n\t\tIsArchived as boolean,\n\t\tCcpRequestBatchId as long,\n\t\tCore as boolean,\n\t\tCcpRequestDetailId as integer,\n\t\tContentProviderId as integer,\n\t\tPolicyNumber as string,\n\t\tIsComplete as boolean,\n\t\tResultCode as integer,\n\t\tResultInfoCode as integer,\n\t\tHighVolumeRequest as integer,\n\t\tSingleRequestDateTime as timestamp,\n\t\tSingleResponseDateTime as timestamp,\n\t\tBatchRefId as string,\n\t\tIsCompleted as boolean,\n\t\tIntegrationPortId as integer,\n\t\tHighVolumeRequestDateTime as timestamp,\n\t\tHighVolumeResponseDateTime as timestamp,\n\t\tSourceCcpRequestBatchId as long,\n\t\tFileName as string,\n\t\tMedicalScheme as string,\n\t\tRequestJSON as integer,\n\t\tRequestFlag as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: true,\n\tformat: 'parquet',\n\twildcardPaths:['staging/UnitOfWork/*']) ~> SRCUnitOfWork\nsource(output(\n\t\tProfileKey as integer,\n\t\tProfileId as integer,\n\t\tCompanyKey as integer,\n\t\tIdNumber as string,\n\t\tEmailAddress as string,\n\t\tFirstName as string,\n\t\tSurname as string,\n\t\tLastLoginDate as timestamp,\n\t\tProfileStatus as integer,\n\t\tIsConfirmed as boolean,\n\t\tLastPasswordFailureDate as timestamp,\n\t\tPasswordFailuresSinceLastSuccess as integer,\n\t\tAdministrationLevel as integer,\n\t\tIdType as integer,\n\t\tTitle as integer,\n\t\tInitials as string,\n\t\tCellNumber as string,\n\t\tWorkNumber as string,\n\t\tFaxNumber as string,\n\t\tAreTermsAndConditionsAccepted as boolean,\n\t\tTermsAndConditionsAcceptDate as timestamp,\n\t\tDefaultPageSize as integer,\n\t\tDefaultParentProfileKey as integer,\n\t\tEntityStatus as string,\n\t\tStatusChangeDate as timestamp,\n\t\tDeletionDate as timestamp,\n\t\tLastChangedBy as string,\n\t\tLastChangedDate as timestamp,\n\t\tCreationDate as timestamp,\n\t\tNote as string,\n\t\tHashAlgorithm as string,\n\t\tProfileGuid as string,\n\t\tDebtorNumber as string,\n\t\tBillingTermsAccepted as boolean,\n\t\tBillingTermsDate as timestamp,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimProfile\nsource(output(\n\t\tTransactionCategoryKey as integer,\n\t\tTransactionCategoryId as integer,\n\t\tName as string,\n\t\tPerUseBilling as boolean,\n\t\tIsEnabled as boolean,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimTransactionCategory\nsource(output(\n\t\tTransactionTypeKey as integer,\n\t\tTransactionTypeId as integer,\n\t\tComponentKey as integer,\n\t\tTransactionCategoryKey as integer,\n\t\tName as string,\n\t\tIsEnabled as boolean,\n\t\tDefaultGeneralLedgerCode as string,\n\t\tIsExcludedFromCompliance as boolean,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimTransactionType\nsource(output(\n\t\tDateKey as integer,\n\t\tDate as timestamp,\n\t\tFullDateUK as string,\n\t\tFullDateUSA as string,\n\t\tDayOfMonth as string,\n\t\tDaySuffix as string,\n\t\tDayName as string,\n\t\tDayOfWeekInMonth as string,\n\t\tDayOfWeekInYear as string,\n\t\tDayOfQuarter as string,\n\t\tDayOfYear as string,\n\t\tWeekOfMonth as string,\n\t\tWeekOfQuarter as string,\n\t\tWeekOfYear as string,\n\t\tMonth as string,\n\t\tMonthName as string,\n\t\tMonthOfQuarter as string,\n\t\tQuarter as string,\n\t\tQuarterName as string,\n\t\tYear as string,\n\t\tYearName as string,\n\t\tMonthYear as string,\n\t\tMMYYYY as string,\n\t\tFirstDayOfMonth as date,\n\t\tLastDayOfMonth as date,\n\t\tFirstDayOfQuarter as date,\n\t\tLastDayOfQuarter as date,\n\t\tFirstDayOfYear as date,\n\t\tLastDayOfYear as date,\n\t\tIsWeekday as boolean,\n\t\tFinancialMonth as string,\n\t\tFinancialMonthName as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimDate\nsource(output(\n\t\tRequestSourceKey as integer,\n\t\tRequestSourceId as string,\n\t\tIsEnabled as boolean,\n\t\tVersionIdentifier as string,\n\t\tSourceType as string,\n\t\tDescription as string,\n\t\tSourceProduct as string,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimRequestSource\nsource(output(\n\t\tClientKey as integer,\n\t\tIdNumber as string,\n\t\tIdType as integer,\n\t\tInitials as string,\n\t\tSurname as string,\n\t\tCellNumber as string,\n\t\tEmailAddress as string,\n\t\tFirstName as string,\n\t\tDateOfBirth as date,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimClient\nsource(output(\n\t\tProductKey as integer,\n\t\tProductId as integer,\n\t\tProductName as string,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimProduct\nsource(output(\n\t\tGroupKey as integer,\n\t\tGroupId as integer,\n\t\tCompanyKey as integer,\n\t\tParentGroupId as integer,\n\t\tName as string,\n\t\tEntityStatusReasonKey as integer,\n\t\tStatusChangeDate as timestamp,\n\t\tDeleteReasonId as integer,\n\t\tDeletionDate as timestamp,\n\t\tLastChangedBy as string,\n\t\tLastChangedDate as timestamp,\n\t\tCreationDate as timestamp,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string,\n\t\tRequestFlag as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimGroup\nsource(output(\n\t\tContentProviderKey as integer,\n\t\tContentProviderId as integer,\n\t\tName as string,\n\t\tProviderCode as string,\n\t\tIntegrationPortId as integer,\n\t\tComponentKey as integer,\n\t\tEntityStatus as integer,\n\t\tEntityStatusReasonKey as integer,\n\t\tStatusChangeDate as timestamp,\n\t\tLastChangedBy as string,\n\t\tLastChangedDate as timestamp,\n\t\tCreationDate as timestamp,\n\t\tHvIntegrationPortId as integer,\n\t\tMachineName as string,\n\t\tScheduledTaskId as integer,\n\t\tIsDeleted as boolean,\n\t\tIsCurrent as boolean,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimContentProvider\nSetisCurrentDefault, SelectDimProfile join(FixCCPRequestColumns@ProfileId == SelectDimProfile@ProfileId\n\t&& SetisCurrentDefault@SourceSystem == SelectDimProfile@SourceSystem\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinProfile\nFixOnbehalfProfileColumnName, SelectDimTransactionCategory join(FixOnbehalfProfileColumnName@TransactionCategoryId == SelectDimTransactionCategory@TransactionCategoryId\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinTransactionCategory\nFixCategoryColumns, SelectDimTransactionType join(EstimatedTransactionTypeId == TransactionTypeId\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinEstimatedTransactionType\nFixDateColumns, SelectDimRequestSource join(RequestSourceCode == RequestSourceId\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinRequestSource\nFixEstimatedTransactionTypeColumnName, SelectDimTransactionType join(ActualTransactionTypeId == TransactionTypeId\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinActualTransactionType\nDimProfile select(mapColumn(\n\t\tProfileKey,\n\t\tProfileId,\n\t\tIsCurrent,\n\t\tCompanyKey,\n\t\tSourceSystem\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimProfile\nDimTransactionCategory select(mapColumn(\n\t\tTransactionCategoryKey,\n\t\tTransactionCategoryId,\n\t\tIsCurrent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimTransactionCategory\nDimTransactionType select(mapColumn(\n\t\tTransactionTypeKey,\n\t\tTransactionTypeId,\n\t\tIsCurrent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimTransactionType\nDimDate select(mapColumn(\n\t\tDateKey,\n\t\tDate,\n\t\tFinancialMonth,\n\t\tFinancialMonthName,\n\t\tMonth,\n\t\tYear,\n\t\tDayOfMonth\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimDate\nJoinEstimatedTransactionType select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey = TransactionTypeKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixEstimatedTransactionTypeColumnName\nDimRequestSource select(mapColumn(\n\t\tRequestSourceKey,\n\t\tRequestSourceId,\n\t\tIsCurrent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimRequestSource\nJoinActualTransactionType select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey = TransactionTypeKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixActualTransactionTypeColumnName\nDimClient select(mapColumn(\n\t\tClientKey,\n\t\tIdNumber,\n\t\tIsCurrent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimClient\nFixRequestSourceColumns, SelectDimClient join(FixRequestSourceColumns@IdNumber == SelectDimClient@IdNumber\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinDimClient\nJoinDimClient select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber = FixRequestSourceColumns@IdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey,\n\t\tTransactionCompletedFinMonth,\n\t\tRequestSourceKey,\n\t\tClientKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixDimClientColumns\nFixProfileColumns, SelectDimProfile join(OnBehalfOfProfileId == SelectDimProfile@ProfileId\n\t&& FixProfileColumns@SourceSystem == SelectDimProfile@SourceSystem\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinOnbehalfProfile\nJoinOnbehalfProfile select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId = FixProfileColumns@ProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey = FixProfileColumns@ProfileKey,\n\t\tCompanyKey = FixProfileColumns@CompanyKey,\n\t\tOnBehalfOfProfileKey = SelectDimProfile@ProfileKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixOnbehalfProfileColumnName\nJoinProfile select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId = FixCCPRequestColumns@ProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tSourceSystem = SelectDimProfile@SourceSystem\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixProfileColumns\nJoinTransactionCategory select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId = FixOnbehalfProfileColumnName@TransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixCategoryColumns\nSetTransactionCompletedFinMonth select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey,\n\t\tTransactionCompletedFinMonth\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixDateColumns\nJoinRequestSource select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey,\n\t\tTransactionCompletedFinMonth,\n\t\tRequestSourceKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixRequestSourceColumns\nFixContentProvider derive(UpdatedDateDW = currentTimestamp(),\n\t\tCreatedDateDW = currentTimestamp(),\n\t\tCreatedByDW = 'ADF Pipeline',\n\t\tSourceSystem = case(RequestFlag=='SingleRequest','AstuteOnline','AstuteOnlineHV'),\n\t\tCcpRequestBatchId = toInteger(CcpRequestBatchId)) ~> DefaultColumns\nFixCCPRequestColumns derive(isCurrentDefault = true(),\n\t\tCreatedDate = toString(null()),\n\t\tSourceSystem = iif(RequestFlag == 'HighVolume', 'AstuteOnlineHV', 'AstuteOnline')) ~> SetisCurrentDefault\nSRCUnitOfWork select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixCCPRequestColumns\nFixActualTransactionTypeColumnName derive(TransactionCompletedFinMonth = case(toInteger(dayOfMonth(toDate(DateTimeTransactionComplete))) > 25,toString(addMonths(toDate(DateTimeTransactionComplete),1),'yyyy-MM-01'), toString(toDate(DateTimeTransactionComplete),'yyyy-MM-01')),\n\t\tDateKey = toInteger(\r\ncase(and(toInteger(dayOfMonth(DateTimeTransactionComplete)) > 25, toInteger(month(DateTimeTransactionComplete)) == 12), \r\nconcat(toString(toInteger(year(DateTimeTransactionComplete)) + 1),'-01','-01'), \r\ncase(toInteger(dayOfMonth(DateTimeTransactionComplete)) > 25,\r\nconcat(toString(year(DateTimeTransactionComplete)),case(length(toString(month(DateTimeTransactionComplete)))<2, concat('0', toString(month(DateTimeTransactionComplete))), toString(toInteger(month(DateTimeTransactionComplete)) + 1)),'-01'),\r\nconcat(toString(year(DateTimeTransactionComplete)),case(length(toString(month(DateTimeTransactionComplete)))<2, concat('0', toString(month(DateTimeTransactionComplete))), toString(month(DateTimeTransactionComplete))),'-01')\r\n)))) ~> SetTransactionCompletedFinMonth\nDimProduct select(mapColumn(\n\t\tProductKey,\n\t\tProductId,\n\t\tIsCurrent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimProduct\nFixDimClientColumns, SelectDimProduct join(CcpProductId == ProductId\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinDimProduct\nJoinDimProduct select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey,\n\t\tTransactionCompletedFinMonth,\n\t\tRequestSourceKey,\n\t\tClientKey,\n\t\tProductKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixDimProductColumns\nDimGroup select(mapColumn(\n\t\tGroupKey,\n\t\tGroupId,\n\t\tIsCurrent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimGroup\nFixDimProductColumns, SelectDimGroup join(FixDimProductColumns@GroupId == SelectDimGroup@GroupId\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinDimGroup\nJoinDimGroup select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId = FixDimProductColumns@GroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey,\n\t\tTransactionCompletedFinMonth,\n\t\tRequestSourceKey,\n\t\tClientKey,\n\t\tProductKey,\n\t\tGroupKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixDimGroup\nFixDimGroup, SelectDimContentProvider join(FixDimGroup@ContentProviderId == SelectDimContentProvider@ContentProviderId\n\t&& isCurrentDefault == IsCurrent,\n\tjoinType:'left',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JoinDimContentProvider\nDimContentProvider select(mapColumn(\n\t\tContentProviderKey,\n\t\tContentProviderId,\n\t\tIsCurrent\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectDimContentProvider\nJoinDimContentProvider select(mapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tGroupId,\n\t\tProfileId,\n\t\tTransactionCategoryId,\n\t\tEstimatedTransactionTypeId,\n\t\tActualTransactionTypeId,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tInvoiceRequestId,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tContentProviderBillingId,\n\t\tOnBehalfOfProfileId,\n\t\tQuantity,\n\t\tMyClientId,\n\t\tCoreOrProducts,\n\t\tCcpServiceId,\n\t\tCNFRateId,\n\t\tParentId,\n\t\tContentProviderTransTypeID,\n\t\tCcpRequestId,\n\t\tMessageId,\n\t\tCombineId,\n\t\tCcpProductId,\n\t\tRequestSourceCode,\n\t\tIdNumber,\n\t\tIdType,\n\t\tInitials,\n\t\tSurname,\n\t\tCellNumber,\n\t\tEmailAddress,\n\t\tFirstName,\n\t\tDateOfBirth,\n\t\tIsArchived,\n\t\tCcpRequestBatchId,\n\t\tCore,\n\t\tCcpRequestDetailId,\n\t\tContentProviderId = FixDimGroup@ContentProviderId,\n\t\tPolicyNumber,\n\t\tIsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tBatchRefId,\n\t\tIsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tisCurrentDefault,\n\t\tCreatedDate,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tOnBehalfOfProfileKey,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey,\n\t\tTransactionCompletedFinMonth,\n\t\tRequestSourceKey,\n\t\tClientKey,\n\t\tProductKey,\n\t\tGroupKey,\n\t\tContentProviderKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FixContentProvider\nDefaultColumns sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tUnitOfWorkId as integer,\n\t\tReferenceNumber as string,\n\t\tMonthlyBalanceControlId as integer,\n\t\tTransactionCategoryKey as integer,\n\t\tEstimatedTransactionTypeKey as integer,\n\t\tActualTransactionTypeKey as integer,\n\t\tEstimatedTransactionValue as decimal(19,4),\n\t\tActualTransactionValue as decimal(19,4),\n\t\tExcessTransactionValue as decimal(19,4),\n\t\tIsTransactionComplete as boolean,\n\t\tIsExcessTransaction as boolean,\n\t\tIsDeferredPriceCalculation as boolean,\n\t\tRequiresInvoiceRequest as boolean,\n\t\tTransactionCompletedFinMonth as date,\n\t\tDateTimeTransactionStarted as timestamp,\n\t\tDateTimeTransactionComplete as timestamp,\n\t\tIsContentProviderTransaction as boolean,\n\t\tOnBehalfOfProfileKey as integer,\n\t\tQuantity as integer,\n\t\tCoreOrProducts as boolean,\n\t\tParentId as integer,\n\t\tCcpRequestId as integer,\n\t\tProductKey as integer,\n\t\tRequestSourceKey as integer,\n\t\tClientKey as integer,\n\t\tCore as boolean,\n\t\tProfileKey as integer,\n\t\tCompanyKey as integer,\n\t\tGroupKey as integer,\n\t\tCcpRequestDetailId as integer,\n\t\tContentProviderKey as integer,\n\t\tPolicyNumber as string,\n\t\tSingleRequestIsComplete as boolean,\n\t\tResultCode as integer,\n\t\tResultInfoCode as integer,\n\t\tHighVolumeRequest as integer,\n\t\tSingleRequestDateTime as timestamp,\n\t\tSingleResponseDateTime as timestamp,\n\t\tCcpRequestBatchId as integer,\n\t\tBatchRefId as integer,\n\t\tHighVolumeIsCompleted as boolean,\n\t\tIntegrationPortId as integer,\n\t\tHighVolumeRequestDateTime as timestamp,\n\t\tHighVolumeResponseDateTime as timestamp,\n\t\tSourceCcpRequestBatchId as long,\n\t\tFileName as string,\n\t\tMedicalScheme as string,\n\t\tRequestJSON as string,\n\t\tRequestFlag as string,\n\t\tCreatedDate as timestamp,\n\t\tUpdatedDateDW as timestamp,\n\t\tCreatedDateDW as timestamp,\n\t\tCreatedByDW as string,\n\t\tSourceSystem as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tUnitOfWorkId,\n\t\tReferenceNumber,\n\t\tMonthlyBalanceControlId,\n\t\tTransactionCategoryKey,\n\t\tEstimatedTransactionTypeKey,\n\t\tActualTransactionTypeKey,\n\t\tEstimatedTransactionValue,\n\t\tActualTransactionValue,\n\t\tExcessTransactionValue,\n\t\tIsTransactionComplete,\n\t\tIsExcessTransaction,\n\t\tIsDeferredPriceCalculation,\n\t\tRequiresInvoiceRequest,\n\t\tTransactionCompletedFinMonth,\n\t\tDateTimeTransactionStarted,\n\t\tDateTimeTransactionComplete,\n\t\tIsContentProviderTransaction,\n\t\tOnBehalfOfProfileKey,\n\t\tQuantity,\n\t\tCoreOrProducts,\n\t\tParentId,\n\t\tCcpRequestId,\n\t\tProductKey,\n\t\tRequestSourceKey,\n\t\tClientKey,\n\t\tCore,\n\t\tProfileKey,\n\t\tCompanyKey,\n\t\tGroupKey,\n\t\tCcpRequestDetailId,\n\t\tContentProviderKey,\n\t\tPolicyNumber,\n\t\tSingleRequestIsComplete = IsComplete,\n\t\tResultCode,\n\t\tResultInfoCode,\n\t\tHighVolumeRequest,\n\t\tSingleRequestDateTime,\n\t\tSingleResponseDateTime,\n\t\tCcpRequestBatchId,\n\t\tBatchRefId,\n\t\tHighVolumeIsCompleted = IsCompleted,\n\t\tIntegrationPortId,\n\t\tHighVolumeRequestDateTime,\n\t\tHighVolumeResponseDateTime,\n\t\tSourceCcpRequestBatchId,\n\t\tFileName,\n\t\tMedicalScheme,\n\t\tRequestJSON,\n\t\tRequestFlag,\n\t\tUpdatedDateDW,\n\t\tCreatedDateDW,\n\t\tCreatedByDW,\n\t\tSourceSystem\n\t)) ~> DSTFactUnitOfWork"
		}
	}
}